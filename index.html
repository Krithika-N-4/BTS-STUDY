<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARMY Study Room ðŸ’œ</title>
    
    <style>
        /* BTS Theme Colors */
        :root {
            --bts-purple: #7B2CBF;
            --light-purple: #C77DFF;
            --dark-bg: #121212;
            --card-bg: #1e1e1e;
            --text-color: #f4f4f4;
            --text-muted: #a9a9a9;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* --- Header --- */
        header {
            background-color: var(--card-bg);
            border-bottom: 3px solid var(--bts-purple);
            padding: 1.5rem 2rem;
            text-align: center;
        }

        header h1 {
            font-size: 2.5rem;
            color: var(--light-purple);
            letter-spacing: 2px;
            font-weight: 700;
        }

        @media (max-width: 768px) {
            header {
                padding: 1rem 1rem;
            }
            
            header h1 {
                font-size: 1.8rem;
                letter-spacing: 1px;
            }
        }

        /* --- Main Layout --- */
        .container {
            display: flex;
            flex-wrap: wrap;
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
            gap: 2rem;
        }

        .main-content {
            flex: 1.3;
            min-width: 300px;
        }

        .sidebar {
            flex: 1;
            min-width: 300px;
        }

        @media (max-width: 1024px) {
            .container {
                margin: 1rem auto;
                gap: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                padding: 0 0.75rem;
                gap: 1rem;
            }
            
            .main-content, .sidebar {
                min-width: 100%;
                width: 100%;
            }
        }

        /* --- Widget Styling --- */
        .widget {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
        }

        .widget h2 {
            color: var(--light-purple);
            border-bottom: 2px solid var(--bts-purple);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        @media (max-width: 768px) {
            .widget {
                padding: 1rem;
                margin-bottom: 1rem;
                border-radius: 8px;
            }
            
            .widget h2 {
                font-size: 1.25rem;
                margin-bottom: 1rem;
            }
        }

        /* --- Progress Grid --- */
        .progress-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .progress-card {
            background-color: #2a2a2a;
            border-radius: 8px;
            padding: 1.5rem 1rem;
            text-align: center;
            border: 1px solid #333;
        }

        .progress-card span {
            display: block;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--light-purple);
        }

        .progress-card p {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        @media (max-width: 480px) {
            .progress-grid {
                gap: 0.75rem;
            }
            
            .progress-card {
                padding: 1rem 0.5rem;
            }
            
            .progress-card span {
                font-size: 2rem;
            }
            
            .progress-card p {
                font-size: 0.8rem;
            }
        }
        
        /* --- Pomodoro Timer --- */
        #timer-display {
            font-size: 5rem;
            font-weight: 700;
            text-align: center;
            color: var(--text-color);
            margin: 1.5rem 0;
            font-family: 'Courier New', Courier, monospace;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        @media (max-width: 768px) {
            #timer-display {
                font-size: 3.5rem;
                margin: 1rem 0;
            }
        }

        @media (max-width: 480px) {
            #timer-display {
                font-size: 2.8rem;
            }
            
            .timer-controls {
                gap: 0.5rem;
            }
        }

        button {
            font-family: inherit;
            font-weight: bold;
            font-size: 1rem;
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        @media (max-width: 480px) {
            button {
                font-size: 0.9rem;
                padding: 0.65rem 1rem;
            }
        }

        .btn-primary {
            background-color: var(--bts-purple);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--light-purple);
        }

        .btn-secondary {
            background-color: #444;
            color: var(--text-color);
        }
        
        .btn-secondary:hover {
            background-color: #666;
        }

        /* --- To-Do List & YouTube Input --- */
        #task-input, #youtube-input {
            width: 100%;
            padding: 0.75rem;
            font-size: 1rem;
            background-color: #333;
            border: 2px solid #555;
            color: var(--text-color);
            border-radius: 5px;
        }

        #task-input {
             margin-bottom: 1rem;
        }
        
        #youtube-input {
            margin-bottom: 0.75rem;
        }

        #task-list {
            list-style: none;
        }

        #task-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background-color: #333;
            border-radius: 5px;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
            cursor: pointer;
            word-break: break-word;
        }

        #task-list li.completed {
            text-decoration: line-through;
            opacity: 0.5;
        }

        #task-list li span {
            flex: 1;
            padding-right: 1rem;
        }

        .delete-btn {
            background: none;
            border: none;
            color: #ff5c5c;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            padding: 0.5rem;
        }

        /* --- Sidebar Widgets --- */
        .youtube-embed {
            width: 100%;
            height: 250px;
            border: none;
            border-radius: 8px;
            margin-top: 1.5rem;
        }

        @media (max-width: 768px) {
            .youtube-embed {
                height: 200px;
            }
        }

        #quote-box {
            font-size: 1.1rem;
            font-style: italic;
            color: var(--text-muted);
            border-left: 4px solid var(--bts-purple);
            padding-left: 1rem;
            min-height: 80px;
        }

        @media (max-width: 480px) {
            #quote-box {
                font-size: 1rem;
                min-height: 60px;
            }
        }

    </style>
</head>
<body>

    <header>
        <h1>ðŸ’œ ARMY Study Hub</h1>
    </header>

    <div class="container">
        
        <main class="main-content">

            <section class="widget">
                <h2>Study Timer (Pomodoro)</h2>
                <div id="timer-display">25:00</div>
                <div class="timer-controls">
                    <button id="start-btn" class="btn-primary">Start</button>
                    <button id="pause-btn" class="btn-secondary">Pause</button>
                    <button id="break-btn" class="btn-secondary">Break (5m)</button>
                    <button id="reset-btn" class="btn-secondary">Reset</button>
                </div>
            </section>
            
            <section class="widget">
                <h2>Today's Progress</h2>
                <div class="progress-grid">
                    <div class="progress-card">
                        <span id="sessions-count">0</span>
                        <p>Sessions</p>
                    </div>
                    <div class="progress-card">
                        <span id="minutes-count">0</span>
                        <p>Minutes</p>
                    </div>
                    <div class="progress-card">
                        <span id="goals-count">0</span>
                        <p>Goals Done</p>
                    </div>
                    <div class="progress-card">
                        <span id="streak-count">1</span>
                        <p>Day Streak ðŸ”¥</p>
                    </div>
                </div>
            </section>

            <section class="widget">
                <h2>Today's Goals</h2>
                <input type="text" id="task-input" placeholder="Add a new study goal...">
                <button id="add-task-btn" class="btn-primary" style="width: 100%;">Add Task</button>
                <ul id="task-list" style="margin-top: 1.5rem;">
                </ul>
            </section>

        </main>
        
        <aside class="sidebar">

            <section class="widget">
                <h2>Study with BTS (Lo-fi)</h2>
                
                <input type="text" id="youtube-input" placeholder="Paste a YouTube link...">
                <button id="load-video-btn" class="btn-primary" style="width:100%;">Load Video</button>

                <iframe 
                    id="video-iframe" class="youtube-embed"
                    width="100%"
                    height="315"
                    src="https://www.youtube.com/embed/TBJVvyMBDdk"
                    title="YouTube video player"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen>
                </iframe>
            </section>

            
            <section class="widget">
                <h2>Motivation (from BTS)</h2>
                <blockquote id="quote-box">
                    "I believe in your galaxy."
                </blockquote>
                <button id="quote-btn" class="btn-secondary" style="width: 100%;">New Quote ðŸ’œ</button>
            </section>

        </aside>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Global Stats Object ---
            let stats = {
                sessions: 0,
                studySeconds: 0,
                goals: 0,
                streak: 1,
                lastVisit: null
            };

            // --- Element Selectors ---
            const taskInput = document.getElementById('task-input');
            const addTaskBtn = document.getElementById('add-task-btn');
            const taskList = document.getElementById('task-list');
            
            const timerDisplay = document.getElementById('timer-display');
            const startBtn = document.getElementById('start-btn');
            const pauseBtn = document.getElementById('pause-btn');
            const resetBtn = document.getElementById('reset-btn');
            const breakBtn = document.getElementById('break-btn'); 
            
            const quoteBox = document.getElementById('quote-box');
            const quoteBtn = document.getElementById('quote-btn');

            const sessionsCount = document.getElementById('sessions-count');
            const minutesCount = document.getElementById('minutes-count');
            const goalsCount = document.getElementById('goals-count');
            const streakCount = document.getElementById('streak-count');

            const youtubeInput = document.getElementById('youtube-input');
            const loadVideoBtn = document.getElementById('load-video-btn');
            const videoIframe = document.getElementById('video-iframe');

            // --- Stats & Local Storage Functions ---

            function updateStatsDisplay() {
                sessionsCount.textContent = stats.sessions;
                minutesCount.textContent = Math.floor(stats.studySeconds / 60);
                goalsCount.textContent = stats.goals;
                streakCount.textContent = stats.streak;
            }

            function saveStats() {
                localStorage.setItem('studyStats', JSON.stringify(stats));
            }

            function initializeStats() {
                const loadedStats = JSON.parse(localStorage.getItem('studyStats'));
                
                if (loadedStats) {
                    stats = loadedStats;
                }

                // Handle Streak Logic
                const today = new Date().toDateString();
                const lastVisitDate = stats.lastVisit ? new Date(stats.lastVisit).toDateString() : null;

                if (lastVisitDate !== today) {
                    const yesterday = new Date(Date.now() - 86400000).toDateString();
                    if (lastVisitDate === yesterday) {
                        stats.streak++;
                    } else if (lastVisitDate !== null) {
                        stats.streak = 1;
                    }
                    
                    // --- NEW RESET CODE ---
                    stats.sessions = 0;
                    stats.studySeconds = 0;
                    stats.goals = 0;
                    localStorage.removeItem('tasks'); // Clears yesterday's to-do list
                    // --- END NEW RESET CODE ---

                    stats.lastVisit = new Date().toISOString();
                }
                
                const loadedTasks = JSON.parse(localStorage.getItem('tasks')) || [];
                stats.goals = loadedTasks.filter(task => task.completed).length;
                
                updateStatsDisplay();
                saveStats();
            }

            window.onbeforeunload = saveStats;

            // --- To-Do List Functions ---

            function saveTasks() {
                const tasks = [];
                taskList.querySelectorAll('li').forEach(li => {
                    tasks.push({
                        text: li.querySelector('span').textContent,
                        completed: li.classList.contains('completed')
                    });
                });
                localStorage.setItem('tasks', JSON.stringify(tasks));
            }

            function createTaskElement(task) {
                const li = document.createElement('li');
                if (task.completed) {
                    li.classList.add('completed');
                }

                const taskSpan = document.createElement('span');
                taskSpan.textContent = task.text;
                
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'âœ–';
                deleteBtn.className = 'delete-btn';

                li.appendChild(taskSpan);
                li.appendChild(deleteBtn);
                taskList.appendChild(li);

                li.addEventListener('click', (e) => {
                    if (e.target.tagName !== 'BUTTON') {
                        li.classList.toggle('completed');
                        if (li.classList.contains('completed')) {
                            stats.goals++;
                        } else {
                            stats.goals--;
                        }
                        updateStatsDisplay();
                        saveStats();
                        saveTasks();
                    }
                });

                deleteBtn.addEventListener('click', () => {
                    if (li.classList.contains('completed')) {
                        stats.goals--; 
                    }
                    taskList.removeChild(li);
                    updateStatsDisplay();
                    saveStats();
                    saveTasks();
                });
            }

            function loadTasks() {
                const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
                tasks.forEach(task => createTaskElement(task));
            }

            function addTask() {
                const taskText = taskInput.value.trim();
                if (taskText === "") {
                    alert("Please enter a task!");
                    return;
                }
                const task = { text: taskText, completed: false };
                createTaskElement(task);
                taskInput.value = "";
                saveTasks();
            }

            addTaskBtn.addEventListener('click', addTask);
            taskInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addTask();
                }
            });

            // --- Pomodoro Timer ---
            let timerInterval;
            let totalSeconds = 25 * 60; 
            let currentMode = 'study'; 
            let isPaused = true;

            function updateTimerDisplay() {
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = totalSeconds % 60;
                timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }

            function startTimer() {
                if (isPaused) {
                    isPaused = false;
                    startBtn.textContent = "Start";
                    
                    timerInterval = setInterval(() => {
                        if (!isPaused) {
                            totalSeconds--;
                            if (currentMode === 'study') {
                                stats.studySeconds++; 
                                if(stats.studySeconds % 60 === 0) {
                                    updateStatsDisplay(); 
                                }
                            }
                            updateTimerDisplay();

                            if (totalSeconds <= 0) {
                                clearInterval(timerInterval);
                                if (currentMode === 'study') {
                                    alert("Study session complete! Take a break! ðŸ’œ");
                                    stats.sessions++;
                                } else {
                                    alert("Break's over! Back to studying! Fighting!");
                                }
                                updateStatsDisplay();
                                saveStats();
                                resetTimer();
                            }
                        }
                    }, 1000);
                }
            }

            function pauseTimer() {
                isPaused = true;
                startBtn.textContent = "Resume";
                clearInterval(timerInterval);
                saveStats(); 
            }

            function resetTimer() {
                isPaused = true;
                clearInterval(timerInterval);
                currentMode = 'study';
                totalSeconds = 25 * 60; 
                updateTimerDisplay();
                startBtn.textContent = "Start";
                saveStats();
            }

            function startBreak() {
                isPaused = true; 
                clearInterval(timerInterval);
                currentMode = 'break';
                totalSeconds = 5 * 60;
                updateTimerDisplay();
                startTimer();
            }

            startBtn.addEventListener('click', startTimer);
            pauseBtn.addEventListener('click', pauseTimer);
            resetBtn.addEventListener('click', resetTimer);
            breakBtn.addEventListener('click', breakBreak);
            
            // --- YouTube Loader Logic ---

            function getYouTubeEmbedUrl(url) {
                let videoId;
                try {
                    const urlObj = new URL(url);
                    if (urlObj.hostname === "www.youtube.com" || urlObj.hostname === "youtube.com") {
                        videoId = urlObj.searchParams.get("v");
                    } else if (urlObj.hostname === "youtu.be") {
                        videoId = urlObj.pathname.slice(1);
                    }
                } catch (e) {
                    console.error("Invalid URL");
                    return null;
                }

                if (videoId) {
                    return `https://www.youtube.com/embed/${videoId}`;
                }
                return null;
            }

            function loadVideo() {
                const newUrl = youtubeInput.value.trim();
                if (newUrl === "") {
                    alert("Please paste a link first!");
                    return;
                }
                
                const embedUrl = getYouTubeEmbedUrl(newUrl);
                
                if (embedUrl) {
                    videoIframe.src = embedUrl;
                    youtubeInput.value = "";
                } else {
                    alert("Please enter a valid YouTube link (e.g., from youtube.com or youtu.be)");
                }
            }
            
            loadVideoBtn.addEventListener('click', loadVideo);
            youtubeInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    loadVideo();
                }
            });

            // --- Motivational Quotes ---
            const btsQuotes = [
                "I believe in your galaxy. - RM",
                "If you can't fly, then run. Today we will survive. - Not Today",
                "Live your life. It's yours anyway. Don't try too hard. It's alright to lose. - Fire",
                "Go on your path, even if you live for a day. - No More Dream",
                "Teamwork makes the dream work. - RM",
                "Don't be trapped in someone else's dream. - V",
                "When things get hard, stop for a while and look back and see how far you've come. - Jin",
                "I have a big heart, so I'm going to love you all. - V",
                "You can't stop me lovin' myself. - Idol",
                "I'm the one I should love in this world. - Jin (Epiphany)",
                "Effort makes you. You will regret it someday if you don't do your best now. - Jungkook",
                "Life is tough, and things don't always work out well, but we should be brave and go on with our lives. - Suga",
                "I'm like a surfer, first you just paddle and fall off the board but as time goes by you can stand up on the bigger waves. - RM"
            ];

            function showNewQuote() {
                const randomIndex = Math.floor(Math.random() * btsQuotes.length);
                quoteBox.textContent = btsQuotes[randomIndex];
            }
            quoteBtn.addEventListener('click', showNewQuote);
            
            // --- Initial Page Load ---
            initializeStats(); 
            loadTasks();       
            showNewQuote();    
            updateTimerDisplay(); 
        });
    </script>

</body>
</html>
